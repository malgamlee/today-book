{"ast":null,"code":"import React, { useState, useEffect } from 'react';\nvar GA4ReactGlobalIndex = '__ga4React__';\n/**\r\n * @desc class required to manage google analitycs 4\r\n * @class GA4React\r\n *  */\n\nclass GA4React {\n  constructor(gaCode, gaConfig, additionalGaCode, timeout, options) {\n    this.gaCode = gaCode;\n    this.gaConfig = gaConfig;\n    this.additionalGaCode = additionalGaCode;\n    this.timeout = timeout;\n    this.options = options;\n    this.scriptSyncId = 'ga4ReactScriptSync';\n    this.scriptAsyncId = 'ga4ReactScriptAsync';\n    this.nonceAsync = '';\n    this.nonceSync = '';\n    this.gaConfig = gaConfig ? gaConfig : {};\n    this.gaCode = gaCode;\n    this.timeout = timeout || 5000;\n    this.additionalGaCode = additionalGaCode;\n    this.options = options;\n\n    if (this.options) {\n      var {\n        nonce\n      } = this.options;\n      this.nonceAsync = nonce && nonce[0] ? nonce[0] : '';\n      this.nonceSync = nonce && nonce[1] ? nonce[1] : '';\n    }\n  }\n  /**\r\n   * @desc output on resolve initialization\r\n   */\n\n\n  outputOnResolve() {\n    return {\n      pageview: this.pageview,\n      event: this.event,\n      gtag: this.gtag\n    };\n  }\n  /**\r\n   * @desc Return main function for send ga4 events, pageview etc\r\n   * @returns {Promise<GA4ReactResolveInterface>}\r\n   */\n\n\n  initialize() {\n    return new Promise((resolve, reject) => {\n      if (GA4React.isInitialized()) {\n        reject(new Error('GA4React is being initialized'));\n      } // in case of retry logics, remove previous scripts\n\n\n      var previousScriptAsync = document.getElementById(this.scriptAsyncId);\n\n      if (previousScriptAsync) {\n        previousScriptAsync.remove();\n      }\n\n      var head = document.getElementsByTagName('head')[0];\n      var scriptAsync = document.createElement('script');\n      scriptAsync.setAttribute('id', this.scriptAsyncId);\n      scriptAsync.setAttribute('async', '');\n\n      if (this.nonceAsync && typeof this.nonceAsync === 'string' && this.nonceAsync.length > 0) {\n        scriptAsync.setAttribute('nonce', this.nonceAsync);\n      }\n\n      scriptAsync.setAttribute('src', \"https://www.googletagmanager.com/gtag/js?id=\" + this.gaCode);\n\n      scriptAsync.onload = () => {\n        var target = document.getElementById(this.scriptSyncId);\n\n        if (target) {\n          target.remove();\n        } // in case of retry logics, remove previous script sync\n\n\n        var previousScriptSync = document.getElementById(this.scriptSyncId);\n\n        if (previousScriptSync) {\n          previousScriptSync.remove();\n        }\n\n        var scriptSync = document.createElement('script');\n        scriptSync.setAttribute('id', this.scriptSyncId);\n\n        if (this.nonceSync && typeof this.nonceSync === 'string' && this.nonceSync.length > 0) {\n          scriptSync.setAttribute('nonce', this.nonceSync);\n        }\n\n        var scriptHTML = \"window.dataLayer = window.dataLayer || [];\\n        function gtag(){dataLayer.push(arguments);};\\n        gtag('js', new Date());\\n        gtag('config', '\" + this.gaCode + \"', \" + JSON.stringify(this.gaConfig) + \");\";\n\n        if (this.additionalGaCode) {\n          this.additionalGaCode.forEach(code => {\n            scriptHTML += \"\\ngtag('config', '\" + code + \"', \" + JSON.stringify(this.gaConfig) + \");\";\n          });\n        }\n\n        scriptSync.innerHTML = scriptHTML;\n        head.appendChild(scriptSync);\n        var resolved = this.outputOnResolve();\n        Object.assign(window, {\n          [GA4ReactGlobalIndex]: resolved\n        });\n        resolve(resolved);\n      };\n\n      scriptAsync.onerror = event => {\n        if (typeof event === 'string') {\n          reject(\"GA4React intialization failed \" + event);\n        } else {\n          var error = new Error();\n          error.name = 'GA4React intialization failed';\n          error.message = JSON.stringify(event, ['message', 'arguments', 'type', 'name']);\n          reject(error);\n        }\n      };\n\n      var onChangeReadyState = () => {\n        switch (document.readyState) {\n          case 'interactive':\n          case 'complete':\n            if (!GA4React.isInitialized()) {\n              head.appendChild(scriptAsync);\n              document.removeEventListener('readystatechange', onChangeReadyState);\n            }\n\n            break;\n        }\n      };\n\n      if (document.readyState !== 'complete') {\n        document.addEventListener('readystatechange', onChangeReadyState);\n      } else {\n        onChangeReadyState();\n      }\n\n      setTimeout(() => {\n        reject(new Error('GA4React Timeout'));\n      }, this.timeout);\n    });\n  }\n  /**\r\n   * @desc send pageview event to gtag\r\n   * @param path\r\n   */\n\n\n  pageview(path, location, title) {\n    return this.gtag('event', 'page_view', {\n      page_path: path,\n      page_location: location || window.location,\n      page_title: title || document.title\n    });\n  }\n  /**\r\n   * @desc set event and send to gtag\r\n   * @param action\r\n   * @param label\r\n   * @param category\r\n   * @param nonInteraction\r\n   */\n\n\n  event(action, label, category, nonInteraction) {\n    if (nonInteraction === void 0) {\n      nonInteraction = false;\n    }\n\n    return this.gtag('event', action, {\n      event_label: label,\n      event_category: category,\n      non_interaction: nonInteraction\n    });\n  }\n  /**\r\n   * @desc direct access to gtag\r\n   * @param args\r\n   */\n\n\n  gtag() {\n    //@ts-ignore\n    return window.gtag(...arguments);\n  }\n  /**\r\n   * @desc ga is initialized?\r\n   */\n\n\n  static isInitialized() {\n    switch (typeof window[GA4ReactGlobalIndex] !== 'undefined') {\n      case true:\n        return true;\n\n      default:\n        return false;\n    }\n  }\n  /**\r\n   * @desc get ga4react from global\r\n   */\n\n\n  static getGA4React() {\n    if (GA4React.isInitialized()) {\n      return window[GA4ReactGlobalIndex];\n    } else {\n      console.error(new Error('GA4React is not initialized'));\n    }\n  }\n\n}\n\nvar outputGA4 = (children, setComponents, ga4) => {\n  setComponents(React.Children.map(children, (child, index) => {\n    if (!React.isValidElement(child)) {\n      return React.createElement(React.Fragment, null, child);\n    } //@ts-ignore\n\n\n    if (child.type && typeof child.type.name !== 'undefined') {\n      return React.cloneElement(child, {\n        //@ts-ignore\n        ga4: ga4,\n        index\n      });\n    } else {\n      return child;\n    }\n  }));\n};\n\nvar GA4R = _ref => {\n  var {\n    code,\n    timeout,\n    config,\n    additionalCode,\n    children,\n    options\n  } = _ref;\n  var [components, setComponents] = useState(null);\n  useEffect(() => {\n    if (!GA4React.isInitialized()) {\n      var ga4manager = new GA4React(\"\" + code, config, additionalCode, timeout, options);\n      ga4manager.initialize().then(ga4 => {\n        outputGA4(children, setComponents, ga4);\n      }, err => {\n        console.error(err);\n      });\n    } else {\n      var ga4 = GA4React.getGA4React();\n\n      if (ga4) {\n        outputGA4(children, setComponents, ga4);\n      }\n    }\n  }, []);\n  return React.createElement(React.Fragment, null, components);\n};\n\nvar useGA4React = (gaCode, gaConfig, gaAdditionalCode, gaTimeout, options) => {\n  var [ga4, setGA4] = useState(undefined);\n  useEffect(() => {\n    if (gaCode) {\n      switch (GA4React.isInitialized()) {\n        case false:\n          var ga4react = new GA4React(\"\" + gaCode, gaConfig, gaAdditionalCode, gaTimeout, options);\n          ga4react.initialize().then(ga4 => {\n            setGA4(ga4);\n          }, err => {\n            console.error(err);\n          });\n          break;\n\n        case true:\n          setGA4(GA4React.getGA4React());\n          break;\n      }\n    } else {\n      setGA4(GA4React.getGA4React());\n    }\n  }, [gaCode]);\n  return ga4;\n};\n\nfunction withTracker(MyComponent) {\n  return props => {\n    var {\n      path,\n      location,\n      title,\n      gaCode,\n      gaTimeout,\n      gaConfig,\n      gaAdditionalCode,\n      options\n    } = props;\n    useEffect(() => {\n      switch (GA4React.isInitialized()) {\n        case true:\n          var ga4 = GA4React.getGA4React();\n\n          if (ga4) {\n            ga4.pageview(path, location, title);\n          }\n\n          break;\n\n        default:\n        case false:\n          var ga4react = new GA4React(\"\" + gaCode, gaConfig, gaAdditionalCode, gaTimeout, options);\n          ga4react.initialize().then(ga4 => {\n            ga4.pageview(path, location, title);\n          }, err => {\n            console.error(err);\n          });\n          break;\n      }\n    });\n    return React.createElement(MyComponent, Object.assign({}, props));\n  };\n}\n\nexport default GA4React;\nexport { GA4R, GA4React, useGA4React, withTracker };","map":{"version":3,"mappings":"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","names":["GA4ReactGlobalIndex","GA4React","constructor","gaCode","gaConfig","additionalGaCode","timeout","options","nonce","nonceAsync","nonceSync","outputOnResolve","pageview","event","gtag","initialize","Promise","resolve","reject","isInitialized","Error","previousScriptAsync","document","getElementById","scriptAsyncId","remove","head","getElementsByTagName","scriptAsync","createElement","setAttribute","length","onload","target","scriptSyncId","previousScriptSync","scriptSync","scriptHTML","JSON","stringify","forEach","code","innerHTML","appendChild","resolved","Object","assign","window","onerror","error","name","message","onChangeReadyState","readyState","removeEventListener","addEventListener","setTimeout","path","location","title","page_path","page_location","page_title","action","label","category","nonInteraction","event_label","event_category","non_interaction","getGA4React","console","outputGA4","children","setComponents","ga4","React","Children","map","child","index","isValidElement","Fragment","type","cloneElement","GA4R","_ref","config","additionalCode","components","useState","useEffect","ga4manager","then","err","useGA4React","gaAdditionalCode","gaTimeout","setGA4","undefined","ga4react","withTracker","MyComponent","props"],"sources":["/Users/jijeong/study/bookStore-app/node_modules/ga-4-react/src/lib/ga4manager.tsx","/Users/jijeong/study/bookStore-app/node_modules/ga-4-react/src/components/GA4RComponents.tsx","/Users/jijeong/study/bookStore-app/node_modules/ga-4-react/src/hooks/useGA4React.tsx","/Users/jijeong/study/bookStore-app/node_modules/ga-4-react/src/components/withTracker.tsx"],"sourcesContent":["import {\n  GA4Config,\n  GA4ManagerOptionsInterface,\n  GA4ReactInterface,\n  GA4ReactResolveInterface,\n  gtagAction,\n  gtagCategory,\n  gtagFunction,\n  gtagLabel,\n} from '../models/gtagModels';\n\nexport const GA4ReactGlobalIndex = '__ga4React__';\n\ndeclare global {\n  interface Window {\n    gtag: gtagFunction | Function;\n    __ga4React__: GA4ReactResolveInterface;\n  }\n}\n\n/**\n * @desc class required to manage google analitycs 4\n * @class GA4React\n *  */\nexport class GA4React implements GA4ReactInterface {\n  private scriptSyncId: string = 'ga4ReactScriptSync';\n  private scriptAsyncId: string = 'ga4ReactScriptAsync';\n  private nonceAsync: string = '';\n  private nonceSync: string = '';\n  constructor(\n    private gaCode: string,\n    private gaConfig?: GA4Config,\n    private additionalGaCode?: Array<string>,\n    private timeout?: number,\n    private options?: GA4ManagerOptionsInterface\n  ) {\n    this.gaConfig = gaConfig ? gaConfig : {};\n    this.gaCode = gaCode;\n    this.timeout = timeout || 5000;\n    this.additionalGaCode = additionalGaCode;\n    this.options = options;\n\n    if (this.options) {\n      const { nonce } = this.options;\n      this.nonceAsync = nonce && nonce[0] ? nonce[0] : '';\n      this.nonceSync = nonce && nonce[1] ? nonce[1] : '';\n    }\n  }\n\n  /**\n   * @desc output on resolve initialization\n   */\n  private outputOnResolve(): GA4ReactResolveInterface {\n    return {\n      pageview: this.pageview,\n      event: this.event,\n      gtag: this.gtag,\n    };\n  }\n\n  /**\n   * @desc Return main function for send ga4 events, pageview etc\n   * @returns {Promise<GA4ReactResolveInterface>}\n   */\n  public initialize(): Promise<GA4ReactResolveInterface> {\n    return new Promise((resolve, reject) => {\n      if (GA4React.isInitialized()) {\n        reject(new Error('GA4React is being initialized'));\n      }\n\n      // in case of retry logics, remove previous scripts\n      const previousScriptAsync = document.getElementById(this.scriptAsyncId);\n      if (previousScriptAsync) {\n        previousScriptAsync.remove();\n      }\n\n      const head: HTMLHeadElement = document.getElementsByTagName('head')[0];\n      const scriptAsync: HTMLScriptElement = document.createElement('script');\n      scriptAsync.setAttribute('id', this.scriptAsyncId);\n      scriptAsync.setAttribute('async', '');\n\n      if (\n        this.nonceAsync &&\n        typeof this.nonceAsync === 'string' &&\n        this.nonceAsync.length > 0\n      ) {\n        scriptAsync.setAttribute('nonce', this.nonceAsync);\n      }\n\n      scriptAsync.setAttribute(\n        'src',\n        `https://www.googletagmanager.com/gtag/js?id=${this.gaCode}`\n      );\n      scriptAsync.onload = () => {\n        const target: HTMLElement | null = document.getElementById(\n          this.scriptSyncId\n        );\n        if (target) {\n          target.remove();\n        }\n\n        // in case of retry logics, remove previous script sync\n        const previousScriptSync = document.getElementById(this.scriptSyncId);\n        if (previousScriptSync) {\n          previousScriptSync.remove();\n        }\n\n        const scriptSync: HTMLScriptElement = document.createElement('script');\n\n        scriptSync.setAttribute('id', this.scriptSyncId);\n\n        if (\n          this.nonceSync &&\n          typeof this.nonceSync === 'string' &&\n          this.nonceSync.length > 0\n        ) {\n          scriptSync.setAttribute('nonce', this.nonceSync);\n        }\n\n        let scriptHTML: string = `window.dataLayer = window.dataLayer || [];\n        function gtag(){dataLayer.push(arguments);};\n        gtag('js', new Date());\n        gtag('config', '${this.gaCode}', ${JSON.stringify(this.gaConfig)});`;\n\n        if (this.additionalGaCode) {\n          this.additionalGaCode.forEach((code: string) => {\n            scriptHTML += `\\ngtag('config', '${code}', ${JSON.stringify(\n              this.gaConfig\n            )});`;\n          });\n        }\n\n        scriptSync.innerHTML = scriptHTML;\n\n        head.appendChild(scriptSync);\n\n        const resolved: GA4ReactResolveInterface = this.outputOnResolve();\n\n        Object.assign(window, { [GA4ReactGlobalIndex]: resolved });\n\n        resolve(resolved);\n      };\n\n      scriptAsync.onerror = (event: Event | string): void => {\n        if (typeof event === 'string') {\n          reject(`GA4React intialization failed ${event}`);\n        } else {\n          const error = new Error();\n          error.name = 'GA4React intialization failed';\n          error.message = JSON.stringify(event, [\n            'message',\n            'arguments',\n            'type',\n            'name',\n          ]);\n          reject(error);\n        }\n      };\n\n      const onChangeReadyState = () => {\n        switch (document.readyState) {\n          case 'interactive':\n          case 'complete':\n            if (!GA4React.isInitialized()) {\n              head.appendChild(scriptAsync);\n              document.removeEventListener(\n                'readystatechange',\n                onChangeReadyState\n              );\n            }\n            break;\n        }\n      };\n\n      if (document.readyState !== 'complete') {\n        document.addEventListener('readystatechange', onChangeReadyState);\n      } else {\n        onChangeReadyState();\n      }\n\n      setTimeout(() => {\n        reject(new Error('GA4React Timeout'));\n      }, this.timeout);\n    });\n  }\n\n  /**\n   * @desc send pageview event to gtag\n   * @param path\n   */\n  public pageview(\n    path: string | Location,\n    location?: string | Location,\n    title?: string\n  ): any {\n    return this.gtag('event', 'page_view', {\n      page_path: path,\n      page_location: location || window.location,\n      page_title: title || document.title,\n    });\n  }\n\n  /**\n   * @desc set event and send to gtag\n   * @param action\n   * @param label\n   * @param category\n   * @param nonInteraction\n   */\n  public event(\n    action: gtagAction,\n    label: gtagLabel,\n    category: gtagCategory,\n    nonInteraction: boolean = false\n  ): any {\n    return this.gtag('event', action, {\n      event_label: label,\n      event_category: category,\n      non_interaction: nonInteraction,\n    });\n  }\n\n  /**\n   * @desc direct access to gtag\n   * @param args\n   */\n  public gtag(...args: any): any {\n    //@ts-ignore\n    return window.gtag(...args);\n  }\n\n  /**\n   * @desc ga is initialized?\n   */\n  static isInitialized(): boolean {\n    switch (typeof window[GA4ReactGlobalIndex] !== 'undefined') {\n      case true:\n        return true;\n      default:\n        return false;\n    }\n  }\n\n  /**\n   * @desc get ga4react from global\n   */\n  static getGA4React(): GA4ReactResolveInterface | void {\n    if (GA4React.isInitialized()) {\n      return window[GA4ReactGlobalIndex];\n    } else {\n      console.error(new Error('GA4React is not initialized'));\n    }\n  }\n}\n\nexport default GA4React;\n","import React, { useState, useEffect } from 'react';\nimport GA4React from './../lib/ga4manager';\nimport {\n  GA4Config,\n  GA4ManagerOptionsInterface,\n  GA4ReactResolveInterface,\n} from '../models/gtagModels';\n\nexport interface IGA4R {\n  code: string;\n  timeout?: number;\n  config?: GA4Config;\n  additionalCode?: Array<string>;\n  children?: any;\n  options?: GA4ManagerOptionsInterface;\n}\n\nconst outputGA4 = (\n  children: any,\n  setComponents: Function,\n  ga4: GA4ReactResolveInterface\n) => {\n  setComponents(\n    React.Children.map(children, (child: React.ReactChildren, index) => {\n      if (!React.isValidElement(child)) {\n        return <React.Fragment>{child}</React.Fragment>;\n      }\n\n      //@ts-ignore\n      if (child.type && typeof child.type.name !== 'undefined') {\n        return React.cloneElement(child, {\n          //@ts-ignore\n          ga4: ga4,\n          index,\n        });\n      } else {\n        return child;\n      }\n    })\n  );\n};\n\nexport const GA4R: React.FC<IGA4R> = ({\n  code,\n  timeout,\n  config,\n  additionalCode,\n  children,\n  options,\n}) => {\n  const [components, setComponents] = useState<any>(null);\n\n  useEffect(() => {\n    if (!GA4React.isInitialized()) {\n      const ga4manager = new GA4React(\n        `${code}`,\n        config,\n        additionalCode,\n        timeout,\n        options\n      );\n      ga4manager.initialize().then(\n        (ga4: GA4ReactResolveInterface) => {\n          outputGA4(children, setComponents, ga4);\n        },\n        err => {\n          console.error(err);\n        }\n      );\n    } else {\n      const ga4 = GA4React.getGA4React();\n      if (ga4) {\n        outputGA4(children, setComponents, ga4);\n      }\n    }\n  }, []);\n\n  return <>{components}</>;\n};\n\nexport default GA4R;\n","import { useState, useEffect } from 'react';\nimport GA4React from '../lib/ga4manager';\n\nimport {\n  GA4Config,\n  GA4ManagerOptionsInterface,\n  GA4ReactResolveInterface,\n} from '../models/gtagModels';\n\nexport const useGA4React = (\n  gaCode?: string,\n  gaConfig?: GA4Config | object,\n  gaAdditionalCode?: Array<string>,\n  gaTimeout?: number,\n  options?: GA4ManagerOptionsInterface\n): GA4ReactResolveInterface | void => {\n  const [ga4, setGA4] = useState<GA4ReactResolveInterface | void>(undefined);\n  useEffect(() => {\n    if (gaCode) {\n      switch (GA4React.isInitialized()) {\n        case false:\n          const ga4react = new GA4React(\n            `${gaCode}`,\n            gaConfig,\n            gaAdditionalCode,\n            gaTimeout,\n            options\n          );\n          ga4react.initialize().then(\n            (ga4: GA4ReactResolveInterface) => {\n              setGA4(ga4);\n            },\n            (err: Error) => {\n              console.error(err);\n            }\n          );\n          break;\n        case true:\n          setGA4(GA4React.getGA4React());\n          break;\n      }\n    } else {\n      setGA4(GA4React.getGA4React());\n    }\n  }, [gaCode]);\n  return ga4;\n};\n","import React, { useEffect } from 'react';\nimport GA4React from '../lib/ga4manager';\n\nimport {\n  GA4Config,\n  GA4ManagerOptionsInterface,\n  GA4ReactResolveInterface,\n} from '../models/gtagModels';\n\nexport interface GA4WithTrackerComponentInterface {\n  path: string | Location;\n  location?: string | Location;\n  title?: string;\n  gaCode?: string;\n  gaConfig?: GA4Config | object;\n  additionalCode?: Array<string>;\n  timeout?: number;\n  options?: GA4ManagerOptionsInterface;\n}\n\nexport function withTracker(\n  MyComponent: React.FC<any>\n): React.FC<GA4WithTrackerComponentInterface> {\n  return (props: GA4WithTrackerComponentInterface & any) => {\n    const {\n      path,\n      location,\n      title,\n      gaCode,\n      gaTimeout,\n      gaConfig,\n      gaAdditionalCode,\n      options,\n    } = props;\n    useEffect(() => {\n      switch (GA4React.isInitialized()) {\n        case true:\n          const ga4 = GA4React.getGA4React();\n          if (ga4) {\n            ga4.pageview(path, location, title);\n          }\n          break;\n        default:\n        case false:\n          const ga4react = new GA4React(\n            `${gaCode}`,\n            gaConfig,\n            gaAdditionalCode,\n            gaTimeout,\n            options\n          );\n          ga4react.initialize().then(\n            (ga4: GA4ReactResolveInterface) => {\n              ga4.pageview(path, location, title);\n            },\n            (err: Error) => {\n              console.error(err);\n            }\n          );\n          break;\n      }\n    });\n    return <MyComponent {...props} />;\n  };\n}\n\nexport default withTracker;\n"]},"metadata":{},"sourceType":"module"}